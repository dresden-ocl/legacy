\documentclass[a4paper]{article}

\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{ngerman}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage{pstricks}

\begin{document}

\begin{center}
\textbf{\LARGE{Dresden OCL2 Toolkit Version 2 Tutorial\newline\newline}}
von Ronny Brandt und Claas Wilke
\end{center}

	Dieses Dokument beschreibt den Einstieg in die Arbeit mit dem Dresden OCL2 Toolkit Version 2. Die Version 2 basiert auf der neuen Infrastruktur des Pivotmodells, das im Großen Beleg von Matthias Bräuer \cite{GBBraeuer} näher beschrieben ist. Weitere Informationen zum Toolkit befinden sich auch auf der Webseite des Dresden OCL2 Toolkit \cite{ToolkitHP}.
	
	Das Tutorial gliedert sich wie folgt: Zunächst wird das Installieren der nötigen Eclipse-Plugins für das Toolkit beschrieben. Anschließend wird das Laden eines domänen-spezifischen Modells und einer Modell-Instanz beschrieben. Dann wird das laden von OCL Expressions erläutert. Zum Abschluss wird noch auf das Interpretieren von OCL Exressions eingegangen.
	
	Die im Folgenden beschriebene Vorgehensweise wurde mit Eclipse 3.3.2 getestet \cite{Ecl}. Neben dem Eclipse SDK müssen auch die erforderlichen Plugins des Eclipse Modeling Framework (EMF) installiert werden. Für dieses Tutorial wurden die EMF-Plugins in Version 2.3.2 verwendet.
	
	Um die EMF-Plugins zu installieren, müssen diese von der EMF-Homepage \cite{EMF} heruntergeladen und in das Plugin-Verzeichniss von Eclipse entpackt werden. Anschließend kann das Eclipse SDK gestartet werden. Alternativ können die Plugins auch nach dem Start des Eclipse SDK über den Eclipse Update Manager installiert werden. 
	
	\section{Das Dresden OCL2 Toolkit installieren}
	
	Um die Werkzeuge des Dresden OCL2 Toolkits nutzen zu können, müssen diese entweder als Eclipse-Plugins installiert werden, oder als Plugin-Projekte in den Eclipse Workspace importiert werden. Beider Vorgehensweisen werden im folgenden kurz erläutert.
	
	\subsection{Installieren der Eclipse-Plugins}
	
	Um das Toolkit als Eclispe-Plugins zu installieren, müssen die Plugins als jar-Archive vorliegen. Diese sind z. B. unter \cite{ToolkitSourceforge} verfügbar. Die jar-Archive müssen einfach in den "`plugins"'-Unterordner des Eclipse SDK kopiert werden. Anschließend kann Eclipse gestartet und mit dem Dresden OCL2 Toolkit 2 gearbeitet werden.
	
	\subsection{Import als Projekte in den Workspace}
	
	Alternativ können die Plugins auch als Projekte in den aktuellen Workspace des Eclipse SDK importiert werden.	Dieser Import kann auf zwei verschiedene Arten erfolgen. Zum einen können die Plugins direkt importiert werden, wenn diese offline vorliegen, z. B. durch eine Quellcode-Distribution, die unter \cite{ToolkitSourceforge} erhältlich ist. 
	
	Die zweite Möglichkeit ist der Import der Plugins aus dem SVN-Verzeichnis (Subversion) des Dresden OCL2 Toolkits. Diese beiden Möglichkeiten werden nun beschrieben.
	
	\subsubsection{Die Plugin-Projekte aus lokalem Verzeichnis importieren}
	
	Es wird davon ausgegangen, dass die Plugins sich in einem lokalen Verzeichnis \lstinline|XYZ| befinden. Für den Import in Eclipse öffnet man den Import-Wizard über das Menü "`File > Import..."` und wählt "`Existing Projects into Workspace"' aus der Gruppe "`General"' (Siehe Abbildung \ref{pic:Import-EPiW}). Im folgenden Fenster wählt man das Verzeichnis \lstinline|XYZ| als Wurzel-Verzeichnis. Anschließend werden die Plugins markiert (falls dies nicht bereits automatisch erfolgt ist) und die Checkbox "`Copy projects into workspace"' aktiviert (Siehe Abbildung \ref{pic:ImportProjects}). Nach der Bestätigung mittels des Buttons "`Finish"' werden die Projekte in den Workspace importiert.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{Bilder/Import-EPiW}
		\caption{Import vorhandener Plugins (1).}
		\label{pic:Import-EPiW}
	\end{figure}
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{Bilder/ImportProjects}
		\caption{Import vorhandener Plugins (2).}
		\label{pic:ImportProjects}
	\end{figure}
	
	\subsubsection{Die Plugin-Projekte aus dem SVN herunterladen}
	
	Um die Plugins direkt aus dem SVN-Repository zu importieren, muss zusätzlich ein Eclipse-Plugin für den Zugriff auf SVN installiert werden. Das nötige Tool heißt Subclipse und ist unter \cite{SVN} verfügbar. Da die Installation von Subclipse auf der Webseite des Supclipse-Plugins \cite{SVNInstall} erläutert wird, wird auf eine Beschreibung an dieser Stelle verzichtet. 
	
	Nach der Installation von Supclipse existiert eine neue "`Perspektive"' für den Zugriff auf SVN im Eclipse SDK. Diese kann über das Menü "`Window > Open Perpective > Other..."' durch Auswahl von "`SVN Repository Exploring"' geöffnet werden. Im View "`SVN Repository"' fügt man ein neues Repository hinzu (Siehe Abbildung \ref{pic:SVN}) und gibt "`https://dresden-ocl.svn.sourceforge.net/svnroot/""dresden-ocl/"' als URL ein. Nach der Auswahl von "`Finish"' erscheint das SVN-Wurzel\-ver\-zeichnis im Repository-View. 
	
	Um die Plugins nun zu importieren, markiert man diese im Repository-Verzeichnis "`trunk/ocl20/eclipse"' und wählt "`Checkout..."' im Kontextmenü (Siehe Abbildung \ref{pic:Checkout}). Die vorgegebenen Einstellungen können übernommen und die Plugins mit einem Klick auf "`Finish"' importiert werden.

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{Bilder/SVN}
		\caption{Hinzufügen eines SVN-Repositories.}
		\label{pic:SVN}
	\end{figure}
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1.0\linewidth]{Bilder/Checkout}
		\caption{Auschecken der erforderlichen Dresden OCL2 Toolkit Plugins.}
		\label{pic:Checkout}
	\end{figure}

	\section{Build des Parsers}
	
	Falls Plugins des Dresden OCL2 Toolkits als Plugin-Projekte importiert wurden, muss nun noch der OCL2-Parser per Build-Skript erstellt werden. Bei einem Installieren der Plugins als jar-Archive ist dieser Schritt zu überspringen. Dazu muss im Projekt "`tudresden.ocl20.pivot.ocl2parser"' die Datei "`build.xml"' ausgewählt und mit Rechtsklick aus dem Kontextmenü die Funktion "`Run As ... > Ant Build"' ausgewählt werden (Siehe Abbildung \ref{pic:Build}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1.0\linewidth]{Bilder/Build}
		\caption{Ausführen des Build-Skripts für den OCL2-Parser.}
		\label{pic:Build}
	\end{figure}
	
	Falls die Fehlermeldung "`Problem: failed to create task or type eclipse.refresh\-Local"' auftritt, muss die Konfiguration des Ant-Skripts angepasst werden. Dazu per Rechtsklick auf der "`build.xml"` die Funktion "`Properties"' auswählen. Dann im neu geöffneten Fenster links die Unterseite "`Run/Debug settings"' auswählen. Dort die Konfiguration "`tudresden.ocl20.pivot.oclparser build.xml"' auswählen und auf die Schaltfläche "`Edit"' klicken. Es öffnet sich ein weiteres Fenster, in diesem im Reiter "`JRE"' die Einstellung "`Run in the same JRE as the workspace"' auswählen und diese Einstellung mit der Schaltfläche "`OK"' bestätigen (Siehe Abbildung \ref{pic:AntConfig}). Anschließend sollte das Ant-Skript ohne Fehlermeldung ausführbar sein.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1.0\linewidth]{Bilder/AntConfig}
		\caption{Einstellen der JRE des Build-Skripts.}
		\label{pic:AntConfig}
	\end{figure}
	
	Nach dem das Build-Skript erfolgreich ausgeführt wurde, müssen die Projekte im Workspace noch aktualisiert werden. Zunächst muss das Projekt "`tudresden.ocl20.pivot.oclparser"' per Rechtsklick aktualisiert werden ("`Refresh"', siehe Abbildung \ref{pic:Refresh}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{Bilder/Refresh}
		\caption{Aktualisieren des Projekts "`tudresden.ocl20.pivot.oclparser"'.}
		\label{pic:Refresh}
	\end{figure}
	
	Anschließend müssen die Projekte noch neu compiliert werden. Dazu ist im Eclipse-Menü die Funktion "`Project > Clean... > Clean all projects"' auszuführen. Danach sollten die Projekte keine Fehler mehr enthalten und ausführbar sein.
	
	\section{OCL2 Toolkit Version 2 nutzen}
	
	Bei einer Installation des OCL2 Toolkits als jar-Archive reicht zum Nutzen des Toolkits das Starten des Eclipse SDK aus. Beim Arbeiten mit importieren Plugin-Projekten im Eclipse Workspace, muss zunächst eine neue Instanz der Eclipse SDK gestartet werden. Diese wird über das Menü "`Run > Run As > Eclipse Application"' ausgeführt. Sollte der Menüpunkt "`Eclipse Application"' nicht vorhanden sein, so muss zunächst eines der Plugins markiert werden. Wenn die neue Instanz gestartet wurde können die Plugins - wie in den folgenden Unterabschnitten beschrieben - verwendet werden.
	
	\subsection{Ein Modell laden}
	
	Nach dem Starten der Eclipse-Umgebung mit den Plugins des Dresden OCL2 Toolkits muss zunächst ein Modell geladen werden. Dies geschieht mit Hilfe eines Import-Wizards (File~>~Import...). 
	In diesem Wizard wird nach der Auswahl des Punktes "`Dresden OCL2 Toolkit > Domain-Specific~Model"' die Modell-Datei und das zugehörige Meta-Modell gewählt (Siehe Abbildung \ref{pic:LoadModel}). Das im Tutorial verwendete PML-Modell befindet sich im Projekt "`tudresden.ocl20.examples.pml"' unter dem Pfad "`model/pml.ecore"'.

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{Bilder/LoadModel}
		\caption{Laden eines domänen-spezifischen Modells.}
		\label{pic:LoadModel}
	\end{figure}
	
	Abbildung \ref{pic:MoBrOE} zeigt das geladene PML-Modell, welches Ecore als Meta-Modell nutzt. Über den Menü-Button (das kleine Dreieck in der rechten oberen Ecke) kann zwischen verschiedenen geladenen Modellen gewechselt werden.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{Bilder/MoBrOE}
		\caption{Geladenes PML-Model im Model Browser.}
		\label{pic:MoBrOE}
	\end{figure}
	
	\subsection{Eine Modell-Instanz laden}
	
	Nach dem Laden des Modells kann, ebenfalls über einen Import-Wizard, eine Modell-Instanz geladen werden. Hierfür ist der Wizard "`Dresden OCL2 Toolkit > Model instance"' zu wählen. Es ist eine Modell-Instanz auszuwählen (im Tutorial handelt es sich um die Datei "`model instance/Testmodell.pml"' des Projekts "`tudresden.ocl20.examples.pml"') und zusätzlich das zuvor geladene domänen-spezifisiche Modell für die Modell-Instanz auszuwählen (Siehe Abbildung \ref{pic:LoadInstance}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{Bilder/LoadInstance}
		\caption{Laden einer PML-Modell-Instanz.}
		\label{pic:LoadInstance}
	\end{figure}
	
	Abbildung \ref{pic:MoInBr} zeigt die geladene Modell-Instanz für das PML-Modell. Auch in dieser Ansicht kann über den Menü-Button zwischen den verfügbaren Modell-Instanzen gewechselt werden. In dem Auswahlmenü werden allerdings nur diejenigen Modell-Instanzen gezeigt, die zum aktiven Modell gehören. Mit dem Wechsel des Modells werden auch die verfügbaren Modell-Instanzen gewechselt.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{Bilder/MoInBr}
		\caption{Geladene PML-Modell-Instanz im Model Instance Browser.}
		\label{pic:MoInBr}
	\end{figure}
	
	\subsection{OCL-Expressions laden}
	\indent
	
	Vor der Interpretation von OCL-Constraints müssen diese noch über einen Import-Wizard importiert werden. Hierfür ist der Wizard "`Dresden OCL2 Toolkit > OCL Expressions"' zu wählen. Es ist eine OCL-Datei auszuwählen (im Tutorial handelt es sich um die Datei "`espressions/testpml.ocl"' des Projekts "`tudresden.ocl20.examples.pml"', siehe Abbildung \ref{pic:LoadExpressions}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{Bilder/LoadExpressions}
		\caption{Der Import von OCL-Expressions für ein zuvor geladenes Modell.}
		\label{pic:LoadExpressions}
	\end{figure}
	
	Die Expressions der gewählten OCL-Datei werden in das aktive Modell geladen. Abbildung \ref{pic:MoBrME} zeigt den "`Model~Browser"' mit dem PML-Modell und den geladenen Expressions.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{Bilder/MoBrME}
		\caption{Geladene Expressions für pml-Model im Model Browser.}
		\label{pic:MoBrME}
	\end{figure}
	
	\subsection{Interpretation von Constraints}
	\indent
	
	Die Interpretation von Constraints erfolgt in der Interpreter-View. Diese bietet ein Menü mit den notwendigen Optionen in Form eines Kontext-Menüs. Das Kontext-Menü zeigt Abbildung \ref{pic:IntViewMen} (Es wird durch einen Klick auf das kleine Dreieck in der rechten oberen Ecke der Interpreter-View geöffnet).
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1\linewidth]{Bilder/IntViewMen}
		\caption{Das Kontext-Menü des Interpreters.}
		\label{pic:IntViewMen}
	\end{figure}
	
	Zur Interpretation der Constraints stehen die Menüpunkte "`Interpret~..."' zur Verfügung. Zunächst können im "`Model~Browser"' die gewünschten Constraints und im "`Model~Instance~Browser"' die gewünschten Modell-Objekte zu Interpretation gewählt werden. Der "`Model~Instance~Browser"' zeigt nur die Modell-Objekte, die zu den gewählten Constraints passen. Im Menü des Interpreters können die zu interpretierenden Typen (Invarianten, Pre- und Postconditions) gewählt werden. Nach der Interpretation zeigt die Tabelle die Ergebnisse. Diese werden entsprechend der Auswahl von Constraints und Modell-Objekten gefiltert. Abbildung \ref{pic:IntView} zeigt die Tabelle mit einer Auswahl von Ergebnissen. Wenn die Länge der Spalte "`Result"' für das Ergebnis nicht ausreichend ist, zeigt ein Doppelklick auf das Objekt in der Zeile das Ergebnis in einem Popup-Fenster.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1\linewidth]{Bilder/IntView}
		\caption{Ausgewählte Ergebnisse in der Interpreter View.}
		\label{pic:IntView}
	\end{figure}
	
	\subsection{Weitere Interpreationsmöglichkeiten}
	
	Vor der Interpretation ist es möglich, den in \cite[Abschnitt Environment]{DABrandt} beschriebenen Vorbereitungsschritt ("`Prepare~..."') für einzelne oder alle Constraints durchzuführen. Das Vorgehen entspricht dem der Interpretation (Auswahl der Constraints, Auswahl der Modell-Objekte, Auswahl der Typen, "`Prepare~..."').
	
	Auch der Menüpunkt "`Add~var~to~environment"' ist zur Vorbereitung der Interpretation von Vor- und Nachbedingungen nutzbar. Mit dessen Hilfe ist es möglich, Variablen zum \lstinline|Environment| hinzuzufügen. Diese werden zum Beispiel für Parameter und Rückgabewerte (result) von Operationen verwendet. Abbildung \ref{pic:AVTEnv} zeigt das Fenster zum Hinzufügen von Variablen. Nach der Angabe des Variablennamens (zum Beispiel "`result"' oder der Name eines Parameters) kann entweder ein Objekt eines primitiven Typs (zum Beispiel Integer) erstellt oder das Ergebnis eines bereits interpretierten Constraints verwendet werden.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.4\linewidth]{Bilder/AVTEnv}
		\caption{Dialog zum Hinzufügen von Variablen zum Environment.}
		\label{pic:AVTEnv}
	\end{figure}
	
	Mit der "`Clear~..."'-Auswahl können die Ergebnisse basierend auf den gewählten Constraints und Modell-Objekten gelöscht werden. "`Remove~Selected~Results"' entfernt die Ergebnisse, die in der Ergebnis-Tabelle selektiert sind.
	
	Mit der Checkbox "`Use~cache"' kann gewählt werden, ob der Interpreter den in \cite{DABrandt} beschriebenen Mechanismus zur Performance-Steigerung nutzt.
	
	\section{Zusammenfassung}
	Dieses Tutorial gab einen Einstieg in die Verwendung des Dresden OCL2 Toolkit Version 2. Es wurde erläutert, wie die Plugins des Toolkits installiert oder importiert und gestartet werden. Anschließend wurde auf die Arbeit mit dem Interpreter des Dresden OCL2 Toolkits eingegangen.
	
	Bei weiteren Informationen zum Dresden OCL2 Toolkit sei hier nochmals auf die Webseite des Dresden OCL2 Toolkits verwiesen \cite{ToolkitHP}.

	\newpage
	\bibliographystyle{alphadin}
	\bibliography{Literatur}

\end{document}
