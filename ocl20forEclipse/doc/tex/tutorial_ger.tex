\documentclass[a4paper]{article}

\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{ngerman}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage{pstricks}

\begin{document}

\begin{center}
\textbf{\LARGE{Eine Einführung in das\newline\newline Dresden OCL2 Toolkit for Eclipse\newline\newline}}
von Ronny Brandt und Claas Wilke
\end{center}

	Dieses Dokument beschreibt den Einstieg in die Arbeit mit dem \textit{Dresden OCL2 Toolkit for Eclipse}. Diese Version des Toolkits basiert auf der neuen Infrastruktur des Pivotmodells, das im Großen Beleg von Matthias Bräuer \cite{GBBraeuer} näher beschrieben ist. Weitere Informationen zum Toolkit befinden sich auch auf der Webseite des \textit{Dresden OCL2 Toolkit} \cite{ToolkitHP}.
	
	Das Tutorial gliedert sich wie folgt: Zunächst wird das Installieren der nötigen \textit{Eclipse}-Plugins für das Toolkit beschrieben. Anschließend wird das Laden eines domänen-spezifischen Modells und einer Modell-Instanz beschrieben. Dann wird das laden von OCL Expressions erläutert. Zum Abschluss wird noch auf das Interpretieren von OCL Exressions eingegangen.
	
	Die im Folgenden beschriebene Vorgehensweise wurde mit \textit{Eclipse 3.3.2} getestet \cite{Ecl}. Das Tutorial sollte aber auch mit \textit{Eclipse 3.4} ausführbar sein. Sofern sich Namen von Menüs und Funktionen in \textit{Eclipse 3.4} geändert haben, ist dies im Tutorial angemerkt. Neben dem \textit{Eclipse SDK} müssen auch die erforderlichen Plugins des \textit{Eclipse Modeling Framework (EMF)} installiert werden. Für dieses Tutorial wurden die \textit{EMF}-Plugins in Version 2.3.2 verwendet.
	
	Um die \textit{EMF}-Plugins zu installieren, müssen diese von der \textit{EMF}-Homepage \cite{EMF} heruntergeladen und in das Plugin-Verzeichniss von \textit{Eclipse} entpackt werden. Anschließend kann das \textit{Eclipse SDK} gestartet werden. Alternativ können die Plugins auch nach dem Start des \textit{Eclipse SDK} über den \textit{Eclipse Update Manager} installiert werden. 
	
	
	
	\section{Das Dresden OCL2 Toolkit for Eclipse installieren}
	
	Um die Werkzeuge des \textit{Dresden OCL2 Toolkit for Eclipse} nutzen zu können, müssen diese entweder als \textit{Eclipse}-Plugins installiert werden, oder als Plugin-Projekte in den \textit{Eclipse-Workspace} importiert werden. Beide Vorgehensweisen werden im folgenden kurz erläutert.
	
	
	\subsection{Installieren der Eclipse-Plugins}
	
	Um das Toolkit als \textit{Eclipse}-Plugins zu installieren, müssen die Plugins als jar-Archive vorliegen. Diese sind z. B. unter \cite{ToolkitSourceforge} verfügbar. Die jar-Archive müssen einfach in den "`plugins"'-Unterordner des \textit{Eclipse SDK} kopiert werden. Anschließend kann \textit{Eclipse} gestartet und mit dem \textit{Dresden OCL2 Toolkit for Eclipse} gearbeitet werden.
	
	
	\subsection{Import als Projekte in den Workspace}
	
	Alternativ können die Plugins auch als Projekte in den aktuellen Workspace des Eclipse SDK importiert werden.	Dieser Import kann auf zwei verschiedene Arten erfolgen. Zum einen können die Plugins direkt importiert werden, wenn diese offline vorliegen, z. B. durch eine Quellcode-Distribution, die unter \cite{ToolkitSourceforge} erhältlich ist. 
	
	Die zweite Möglichkeit ist der Import der Plugins aus dem SVN-Verzeichnis (\textit{Subversion}) des \textit{Dresden OCL2 Toolkits}. Diese beiden Möglichkeiten werden nun beschrieben.
	
	
	\subsubsection{Die Plugin-Projekte aus lokalem Verzeichnis importieren}
	
	Es wird davon ausgegangen, dass die Plugins sich in einem lokalen Verzeichnis \lstinline|XYZ| befinden. Für den Import in \textit{Eclipse} öffnet man den \textit{Import-Wizard} über das Menü "`File > Import..."` und wählt "`Existing Projects into Workspace"' aus der Gruppe "`General"' (Siehe Abbildung \ref{pic:Import-EPiW}). Im folgenden Fenster wählt man das Verzeichnis \lstinline|XYZ| als Wurzel-Verzeichnis. Anschließend werden die Plugins markiert (falls dies nicht bereits automatisch erfolgt ist) und die Checkbox "`Copy projects into workspace"' aktiviert (Siehe Abbildung \ref{pic:ImportProjects}). Nach der Bestätigung mittels des Buttons "`Finish"' werden die Projekte in den Workspace importiert.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{figures/Import-EPiW}
		\caption{Import vorhandener Plugins (1).}
		\label{pic:Import-EPiW}
	\end{figure}
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{figures/ImportProjects}
		\caption{Import vorhandener Plugins (2).}
		\label{pic:ImportProjects}
	\end{figure}
	
	
	\subsubsection{Die Plugin-Projekte aus dem SVN herunterladen}
	
	Um die Plugins direkt aus dem \textit{SVN}-Repository zu importieren, muss zusätzlich ein \textit{Eclipse-Plugin} für den Zugriff auf \textit{SVN} installiert werden. Das nötige Tool heißt \textit{Subclipse} und ist unter \cite{SVN} verfügbar. Die Installation von \textit{Subclipse} wird auf der Webseite des \textit{Supclipse}-Plugins \cite{SVNInstall} erläutert.
	
	\textbf{Achtung: Derzeit funktioniert das \textit{Subclipse}-Plugin nicht unter \textit{Eclipse 3.4}.} Unter \textit{Eclipse 3.4} sollte ein ähnliches \textit{Eclipse}-Plugin oder ein anderes Tool für den Zugriff auf \textit{SVN-Repositories} außerhalb von \textit{Eclipse} verwendet werden.
	
	Nach der Installation von \textit{Supclipse} existiert eine neue \textit{Perspective} für den Zugriff auf \textit{SVN} im \textit{Eclipse SDK}. Diese kann über das Menü "`Window > Open Perpective > Other..."' durch Auswahl von "`SVN Repository Exploring"' geöffnet werden. Im View \textit{SVN Repository} fügt man ein neues Repository hinzu (Siehe Abbildung \ref{pic:SVN}) und gibt "`https://dresden-ocl.svn.sourceforge.net/svnroot/""dresden-ocl/"' als URL ein. Nach der Auswahl von "`Finish"' erscheint das SVN-Wurzel\-ver\-zeichnis im \textit{Repository-View}. 
	
	Um die Plugins nun zu importieren, markiert man diese im Repository-Verzeichnis "`trunk/ocl20forEclipse/eclipse"' und wählt "`Checkout..."' im Kontextmenü (Siehe Abbildung \ref{pic:Checkout}). Die vorgegebenen Einstellungen können übernommen und die Plugins mit einem Klick auf "`Finish"' importiert werden.

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{figures/SVN}
		\caption{Hinzufügen eines SVN-Repositories.}
		\label{pic:SVN}
	\end{figure}
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1.0\linewidth]{figures/Checkout}
		\caption{Auschecken der erforderlichen Dresden OCL2 Toolkit Plugins.}
		\label{pic:Checkout}
	\end{figure}



	\section{Build des Parsers}
	
	Falls die Plugins des \textit{Dresden OCL2 Toolkits for Eclipse} als \textit{Plugin-Projekte} importiert wurden, muss nun noch der \textit{OCL2-Parser} per Build-Skript erstellt werden. Bei einem Installieren der Plugins als jar-Archive ist dieser Schritt zu überspringen. Dazu muss im Projekt "`tudresden.ocl20.pivot.ocl2parser"' die Datei "`build.xml"' ausgewählt und mit Rechtsklick aus dem Kontextmenü die Funktion "`Run As ... > Ant Build"' ausgewählt werden (Siehe Abbildung \ref{pic:Build}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1.0\linewidth]{figures/Build}
		\caption{Ausführen des Build-Skripts für den OCL2-Parser.}
		\label{pic:Build}
	\end{figure}
	
	Falls die Fehlermeldung "`Problem: failed to create task or type eclipse.refresh\-Local"' auftritt, muss die Konfiguration des \textit{Ant}-Skripts angepasst werden. Dazu per Rechtsklick auf der "`build.xml"` die Funktion "`Properties"' auswählen. Dann im neu geöffneten Fenster links die Unterseite "`Run/Debug settings"' auswählen. Dort die Konfiguration "`tudresden.ocl20.pivot.oclparser build.xml"' auswählen und auf die Schaltfläche "`Edit"' klicken. Es öffnet sich ein weiteres Fenster, in diesem im Reiter "`JRE"' die Einstellung "`Run in the same JRE as the workspace"' auswählen und diese Einstellung mit der Schaltfläche "`OK"' bestätigen (Siehe Abbildung \ref{pic:AntConfig}). Anschließend sollte das \textit{Ant}-Skript ohne Fehlermeldung ausführbar sein.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1.0\linewidth]{figures/AntConfig}
		\caption{Einstellen der JRE des Build-Skripts.}
		\label{pic:AntConfig}
	\end{figure}
	
	Nach dem das Build-Skript erfolgreich ausgeführt wurde, müssen die Projekte im Workspace noch aktualisiert werden. Zunächst muss das Projekt "`tudresden.ocl20.pivot.oclparser"' per Rechtsklick aktualisiert werden ("`Refresh"', siehe Abbildung \ref{pic:Refresh}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{figures/Refresh}
		\caption{Aktualisieren des Projekts "`tudresden.ocl20.pivot.oclparser"'.}
		\label{pic:Refresh}
	\end{figure}
	
	Anschließend müssen die Projekte noch neu compiliert werden. Dazu ist im \textit{Eclipse}-Menü die Funktion "`Project > Clean... > Clean all projects"' auszuführen. Danach sollten die Projekte keine Fehler mehr enthalten und ausführbar sein.
	
	
	
	\section{OCL2 Toolkit for Eclipse nutzen}
	
	Bei einer Installation des \textit{OCL2 Toolkits for Eclipse} als jar-Archive reicht zum Nutzen des Toolkits das Starten des \textit{Eclipse SDK} aus. Beim Arbeiten mit importieren Plugin-Projekten im \textit{Eclipse Workspace}, muss zunächst eine neue Instanz der \textit{Eclipse SDK} gestartet werden. Diese wird über das Menü "`Run > Run As > Eclipse Application"' ausgeführt. Sollte der Menüpunkt "`Eclipse Application"' nicht vorhanden sein, so muss zunächst eines der Plugins markiert werden (Eventuell muss zum Ausführen auch noch das \textit{Eclipse Plugin Development Environment} installiert werden).Wenn die neue Instanz gestartet wurde können die Plugins - wie in den folgenden Unterabschnitten beschrieben - verwendet werden.
	
	
	\subsection{Ein Modell laden}
	
	Nach dem Starten der \textit{Eclipse}-Umgebung mit den Plugins des \textit{Dresden OCL2 Toolkit for Eclipse} muss zunächst ein Modell geladen werden. Dies geschieht mit Hilfe eines \textit{Import-Wizards} (File~>~Import...). 
	In diesem Wizard wird nach der Auswahl des Punktes "`Dresden OCL2 Toolkit > Domain-Specific~Model"' die Modell-Datei und das zugehörige Meta-Modell gewählt (Siehe Abbildung \ref{pic:LoadModel}). Das im Tutorial verwendete \textit{PML}-Modell befindet sich im Projekt "`tudresden.ocl20.pivot.examples.pml"' unter dem Pfad "`model/pml.ecore"'. Andere Beispiele die im \textit{Dresden OCL2 Toolkit for Eclipse} werden am Ende dieses Tutorials aufgeführt.

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{figures/LoadModel}
		\caption{Laden eines domänen-spezifischen Modells.}
		\label{pic:LoadModel}
	\end{figure}

	Abbildung \ref{pic:MoBrOE} zeigt das geladene \textit{PML}-Modell, welches \textit{Ecore} als Meta-Modell nutzt. Über den Menü-Button (das kleine Dreieck in der rechten oberen Ecke) kann zwischen verschiedenen geladenen Modellen gewechselt werden (Siehe Abbildung \ref{pic:SwitchModel}).
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{figures/MoBrOE}
		\caption{Geladenes \textit{PML}-Model im Model Browser.}
		\label{pic:MoBrOE}
	\end{figure}

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{figures/SwitchModel}
		\caption{Wechsel zwischen den geladenenen Modell-Instanzen.}
		\label{pic:SwitchModel}
	\end{figure}
	
	
	\subsection{Eine Modell-Instanz laden}
	
	Nach dem Laden des Modells kann, ebenfalls über einen \textit{Import-Wizard}, eine \textit{Modell-Instanz} geladen werden. Hierfür ist der Wizard "`Dresden OCL2 Toolkit > Model instance"' zu wählen. Es ist eine Modell-Instanz auszuwählen (im Tutorial handelt es sich um die Datei "`model instance/Testmodell.pml"' des Projekts "`tudresden.ocl20.pivot.examples.pml"') und zusätzlich das zuvor geladene \textit{domänen-spezifisiche Modell} für die Modell-Instanz auszuwählen (Siehe Abbildung \ref{pic:LoadInstance}). 
	
	Falls die Plugins des \textit{Dresden OCL2 Toolkit for Eclipse} als jar-Archive installiert wurden, muss dass entsprechende \textit{PML}-Plugin zunächst noch in den \textit{Workspace} importiert werden. Legen sie dazu ein neues Projekt in Ihrem \textit{Workspace} an und wählen sie dann den \textit{Import-Wizard} "`General -> Archive File"'; im folgenden Fenster wählen sie aus dem "`plugins"'-Verzeichnis ihrer \textit{Eclipse}-Instanz das Archiv "`tudresden.ocl20.pivot.examples.living\_1.0.0.jar"' aus und klicken den "`Finish"'-Button.

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{figures/LoadInstance}
		\caption{Laden einer \textit{PML}-Modell-Instanz.}
		\label{pic:LoadInstance}
	\end{figure}
	
	Abbildung \ref{pic:MoInBr} zeigt die geladene Modell-Instanz für das \textit{PML}-Modell. Auch in dieser Ansicht kann (analog zur Modell-Ansicht) über den Menü-Button zwischen den verfügbaren Modell-Instanzen gewechselt werden (in einigen Fällen muss die Modell-Instanz nach dem Laden erst über das Dreieck ausgewählt werden, bevor sie im Browser angezeigt wird). In dem Auswahlmenü werden allerdings nur diejenigen Modell-Instanzen gezeigt, die zum aktiven Modell gehören. Mit dem Wechsel des Modells werden auch die verfügbaren Modell-Instanzen gewechselt.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{figures/MoInBr}
		\caption{Geladene \textit{PML}-Modell-Instanz im Model Instance Browser.}
		\label{pic:MoInBr}
	\end{figure}
	

	\subsection{OCL-Expressions laden}
	\indent
	
	Vor der Interpretation von OCL-Constraints müssen diese noch über einen \textit{Import-Wizard} importiert werden. Hierfür ist der \textit{Wizard} "`Dresden OCL2 Toolkit > OCL Expressions"' zu wählen. Es ist eine OCL-Datei auszuwählen (im Tutorial handelt es sich um die Datei "`espressions/testpml.ocl"' des Projekts "`tudresden.ocl20.pivot.examples.pml"', siehe Abbildung \ref{pic:LoadExpressions}).

	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{figures/LoadExpressions}
		\caption{Der Import von OCL-Expressions für ein zuvor geladenes Modell.}
		\label{pic:LoadExpressions}
	\end{figure}
	
	Die Expressions der gewählten OCL-Datei werden in das aktive Modell geladen. Abbildung \ref{pic:MoBrME} zeigt den "`Model~Browser"' mit dem \textit{PML}-Modell und den geladenen Expressions.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{figures/MoBrME}
		\caption{Geladene Expressions für das \textit{PML}-Model im \textit{Model Browser}.}
		\label{pic:MoBrME}
	\end{figure}
	

	\subsection{Interpretation von Constraints}
	\indent
	
	Die Interpretation von Constraints erfolgt in der \textit{Interpreter-View}. Eventuell muss diese zunächst geöffnet werden. Dies geschieht über die Menü-Funktion "`Window -> Show View -> Other... "`. Im sich öffnenden Fenster ist dann die \textit{View} "`TU Dresden OCL2 Toolkit -> Interpreter"' auszuwählen.
	
	Die \textit{Interpreter View} bietet ein Menü mit den notwendigen Optionen in Form eines Kontext-Menüs. Das Kontext-Menü zeigt Abbildung \ref{pic:IntViewMen} (Es wird durch einen Klick auf das kleine Dreieck in der rechten oberen Ecke der \textit{Interpreter-View} geöffnet).
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1\linewidth]{figures/IntViewMen}
		\caption{Das Kontext-Menü des Interpreters.}
		\label{pic:IntViewMen}
	\end{figure}
	
	Zur Interpretation der Constraints stehen die Menüpunkte "`Interpret~..."' zur Verfügung. Zunächst können im \textit{Model Browser} die gewünschten Constraints und im \textit{Model Instance Browser} die gewünschten Modell-Objekte zu Interpretation gewählt werden. Der \textit{Model Instance Browser} zeigt nur die Modell-Objekte, die zu den gewählten Constraints passen. Im Menü des Interpreters können die zu interpretierenden Typen (Invarianten, Pre- und Postconditions) gewählt werden. Nach der Interpretation zeigt die \textit{Interpreter View} die Ergebnisse. Diese werden entsprechend der Auswahl von Constraints und Modell-Objekten gefiltert. Abbildung \ref{pic:IntView} zeigt die Tabelle mit einer Auswahl von Ergebnissen. Wenn die Länge der Spalte "`Result"' für das Ergebnis nicht ausreichend ist, zeigt ein Doppelklick auf das Objekt in der Zeile das Ergebnis in einem Popup-Fenster.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=1\linewidth]{figures/IntView}
		\caption{Ausgewählte Ergebnisse in der \textit{Interpreter View}.}
		\label{pic:IntView}
	\end{figure}
	
	
	\subsection{Weitere Interpreationsmöglichkeiten}
	
	Vor der Interpretation ist es möglich, den in \cite[Abschnitt Environment]{DABrandt} beschriebenen Vorbereitungsschritt ("`Prepare~..."') für einzelne oder alle Constraints durchzuführen. Das Vorgehen entspricht dem der Interpretation (Auswahl der Constraints, Auswahl der Modell-Objekte, Auswahl der Typen, "`Prepare~..."').
	
	Auch der Menüpunkt "`Add~var~to~environment"' ist zur Vorbereitung der Interpretation von Vor- und Nachbedingungen nutzbar. Mit dessen Hilfe ist es möglich, Variablen zum \lstinline|Environment| hinzuzufügen. Diese werden zum Beispiel für Parameter und Rückgabewerte (result) von Operationen verwendet. Abbildung \ref{pic:AVTEnv} zeigt das Fenster zum Hinzufügen von Variablen. Nach der Angabe des Variablennamens (zum Beispiel "`result"' oder der Name eines Parameters) kann entweder ein Objekt eines primitiven Typs (zum Beispiel Integer) erstellt oder das Ergebnis eines bereits interpretierten Constraints verwendet werden.
	
	\begin{figure}[!htbp]
		\centering
		\includegraphics[width=0.4\linewidth]{figures/AVTEnv}
		\caption{Dialog zum Hinzufügen von Variablen zum \textit{Environment}.}
		\label{pic:AVTEnv}
	\end{figure}
	
	Mit der "`Clear~..."'-Auswahl können die Ergebnisse basierend auf den gewählten Constraints und Modell-Objekten gelöscht werden. "`Remove~Selected~Results"' entfernt die Ergebnisse, die in der Ergebnis-Tabelle selektiert sind.
	
	Mit der Checkbox "`Use~cache"' kann gewählt werden, ob der Interpreter den in \cite{DABrandt} beschriebenen Mechanismus zur Performance-Steigerung nutzt.
	
	
	\section{Zusammenfassung}
	Dieses Tutorial gab einen Einstieg in die Verwendung des \textit{Dresden OCL2 Toolkit for Eclipse}. Es wurde erläutert, wie die Plugins des Toolkits installiert oder importiert und gestartet werden. Anschließend wurde auf die Arbeit mit dem Interpreter des \textit{Dresden OCL2 Toolkit for Eclipse} eingegangen.
	
	In diesem Tutorial wurde das Arbeiten mit dem \textit{Dresden OCL2 Toolkit for Eclipse} anhand des PML-Modells erläutert. Tabelle \ref{tab:examples} zeigt eine Übersicht über die derzeit mit dem Toolkit bereitgestellten Beispiele.
	
  \begin{table}
    \begin{tabular}[h]{|r|l|}
      \hline
      \textbf{PML-Beispiel} & \\
      Plugin & tudresden.ocl20.pivot.examples.pml\\
      Meta-Modell & Ecore\\
      Modell & model/pml.ecore\\
      OCL-Expressions & expressions/testpml.ocl\\
      Model-Instanz & model instance/Testmodell.pml\\
      \hline
      \hline
      \textbf{Living-Beispiel} & \\
      Plugin & tudresden.ocl20.pivot.examples.living\\
      Meta-Modell & UML 1.5 oder UML 2.0\\
      Modell & model/UmlExample.xmi\\
      OCL-Expressions & expressions/living.ocl\\
      Model-Instanz & src/tudresden.ocl20.pivot.examples.living/ModelProviderClass.java\\
      \hline
    \end{tabular}
    \caption{Übersicht über Beispiele für das \textit{Dresden OCL2 Toolkit for Eclipse}.}
    \label{tab:examples}
  \end{table}

	Bei weiteren Informationen zum \textit{Dresden OCL2 Toolkit} sei hier nochmals auf die Webseite des \textit{Dresden OCL2 Toolkits} verwiesen \cite{ToolkitHP}.

	\newpage
	\bibliographystyle{alphadin}
	\bibliography{tutorial_ger}

\end{document}
